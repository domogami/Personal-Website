{"version":3,"sources":["../../src/commands/serve.js"],"names":["handler","require","openurl","http","signalExit","module","exports","port","program","open","parseInt","server","createServer","request","response","public","listen","openUrlString","console","log","code","signal","close"],"mappings":";;AAAA;AACA,IAAMA,UAAUC,QAAS,eAAT,CAAhB;AACA,IAAMC,UAAUD,QAAS,KAAT,CAAhB;AACA,IAAME,OAAOF,QAAS,MAAT,CAAb;AACA,IAAMG,aAAaH,QAAS,aAAT,CAAnB;;AAEAI,OAAOC,OAAP,GAAiB,mBAAW;AAAA,MACpBC,IADoB,GACLC,OADK,CACpBD,IADoB;AAAA,MACdE,IADc,GACLD,OADK,CACdC,IADc;;AAE1BF,SAAO,OAAOA,IAAP,KAAiB,QAAjB,GAA2BG,SAASH,IAAT,EAAe,EAAf,CAA3B,GAAgDA,IAAvD;;AAEA,MAAII,SAASR,KAAKS,YAAL,CAAkB,UAACC,OAAD,EAAUC,QAAV;AAAA,WAC7Bd,QAAQa,OAAR,EAAiBC,QAAjB,EAA2B;AACzBC,cAAS;AADgB,KAA3B,CAD6B;AAAA,GAAlB,CAAb;;AAMAJ,SAAOK,MAAP,CAAcT,IAAd,EAAoB,YAAM;AACxB,QAAIU,gBAAiB,mBAAD,GAAsBV,IAA1C;AACAW,YAAQC,GAAR,CAAa,0BAAb,EAAwCF,aAAxC;AACA,QAAIR,IAAJ,EAAU;AACR,UAAIQ,iBAAiB,mBAAD,GAAsBV,IAA1C;AACAW,cAAQC,GAAR,CAAa,oBAAb;AACAjB,cAAQe,cAAR;AACD;AACF,GARD;;AAUAb,aAAW,UAACgB,IAAD,EAAOC,MAAP,EAAkB;AAC3BV,WAAOW,KAAP;AACD,GAFD;AAGD,CAvBD","file":"serve.js","sourcesContent":["/* @flow weak */\nconst handler = require(`serve-handler`)\nconst openurl = require(`opn`)\nconst http = require(`http`)\nconst signalExit = require(`signal-exit`)\n\nmodule.exports = program => {\n  let { port, open } = program\n  port = typeof port === `string` ? parseInt(port, 10) : port\n\n  let server = http.createServer((request, response) =>\n    handler(request, response, {\n      public: `public`,\n    })\n  )\n\n  server.listen(port, () => {\n    let openUrlString = `http://localhost:` + port\n    console.log(`gatsby serve running at:`, openUrlString)\n    if (open) {\n      let openUrlString = `http://localhost:` + port\n      console.log(`Opening browser...`)\n      openurl(openUrlString)\n    }\n  })\n\n  signalExit((code, signal) => {\n    server.close()\n  })\n}\n"]}